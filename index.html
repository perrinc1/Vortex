<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>HÃ©bergeur de Jeux Web</title>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.1"></script>
    <style>
        body { font-family: sans-serif; background: #111; color: white; text-align: center; padding: 50px; }
        .container { background: #222; padding: 20px; border-radius: 10px; display: inline-block; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        .game-card { background: #333; margin: 10px; padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

    <div class="container">
        <h1>ðŸŽ® Mon HÃ©bergeur de Jeux</h1>
        <input type="file" id="fileInput">
        <button onclick="uploadGame()">Mettre en ligne</button>
        <p id="status"></p>

        <hr>
        <h3>Jeux disponibles</h3>
        <div id="gameList">Chargement...</div>
    </div>

    <script>
        const client = new Appwrite.Client()
            .setEndpoint('https://fra.cloud.appwrite.io/v1') 
            .setProject('alexandrelevet1971'); 

        const storage = new Appwrite.Storage(client);
        const BUCKET_ID = 'alexandrelevet1972'; 

        async function uploadGame() {
            const file = document.getElementById('fileInput').files[0];
            const status = document.getElementById('status');
            if (!file) return alert("Choisis un fichier !");
            status.innerText = "TÃ©lÃ©chargement en cours...";
            try {
                await storage.createFile(BUCKET_ID, Appwrite.ID.unique(), file);
                status.innerText = "SuccÃ¨s !";
                loadGames();
            } catch (e) {
                status.innerText = "Erreur : " + e.message;
            }
        }

        async function loadGames() {
            const list = document.getElementById('gameList');
            try {
                const res = await storage.listFiles(BUCKET_ID);
                if (res.files.length === 0) {
                    list.innerText = "Aucun jeu pour le moment.";
                } else {
                    list.innerHTML = res.files.map(file => `
                        <div class="game-card">
                            <span>${file.name}</span>
                            <button onclick="window.open('${storage.getFileView(BUCKET_ID, file.$id)}')">Jouer</button>
                        </div>
                    `).join('');
                }
            } catch (e) {
                list.innerText = "Erreur de connexion Ã  Appwrite.";
                console.error(e);
            }
        }
        loadGames();
    </script>
</body>
</html>
