<script>
    const client = new Appwrite.Client()
        // Utilise bien le serveur "fra" comme indiqué dans tes réglages
        .setEndpoint('https://fra.cloud.appwrite.io/v1') 
        .setProject('alexandrelevet1971'); 

    const storage = new Appwrite.Storage(client);
    // Utilise ton nouveau Bucket
    const BUCKET_ID = 'alexandrelevet1972'; 

    async function uploadGame() {
        const file = document.getElementById('fileInput').files[0];
        const status = document.getElementById('status');
        if (!file) return alert("Choisis un fichier .zip !");

        status.innerText = "Téléchargement en cours...";

        try {
            await storage.createFile(BUCKET_ID, Appwrite.ID.unique(), file);
            status.innerText = "Succès ! Recharge la page.";
            loadGames();
        } catch (e) {
            status.innerText = "Erreur : " + e.message;
            console.error(e);
        }
    }

    async function loadGames() {
        const list = document.getElementById('gameList');
        try {
            const res = await storage.listFiles(BUCKET_ID);
            list.innerHTML = res.files.map(file => `
                <div class="game-card">
                    <span>${file.name}</span>
                    <button onclick="window.open('${storage.getFileView(BUCKET_ID, file.$id)}')">Jouer / Télécharger</button>
                </div>
            `).join('');
        } catch (e) {
            list.innerText = "Erreur de chargement des jeux.";
            console.error(e);
        }
    }
    loadGames();
</script>
